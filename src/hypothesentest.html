<!DOCTYPE html>
<html lang="de">
	<head>
		<meta charset="utf-8"/>
	</head>
	<script>
		window.onload = aufgabe;
		
		things = ["Schrauben", "Handys", "Äpfeln"]
		operator = ["mehr","weniger","≤","≥"]
		people = ["Händler","Käufer"]
		doing = ["verkauft","kauft"]
		t = 0;
		p = 0;
		op = 0;
		solution = [];
		
		function binomial(k) {
			var coeff = 1;
			for (var x = n-k+1; x <= n; x++) coeff *= x;
			for (x = 1; x <= k; x++) coeff /= x;
			return coeff;
		}
		
		function prop(k) {
			return binomial(k)*Math.pow(p,k)*Math.pow((1-p),(n-k));
		}
		
		function aufgabe(){
			document.getElementById("leftborder").value = "";
			document.getElementById("rightborder").value = "";
			document.getElementById("return").innerHTML = "";
			document.getElementById("left").checked = false;
			document.getElementById("right").checked = false;
			
			t = Math.floor(Math.random() * 3);
			p = Math.floor(Math.random() * 97)+3;
			if(p >= 50) op = 0;
			else op = 1;
			n = Math.floor(Math.random() * 190)+10;
			signiv = Math.floor(Math.random() * 7)+3;
			task = "Ein  "+people[op]+" behauptet, dass unter den "+things[t]+", die er "+doing[op]+", "+operator[op]+" als "+p+"% ohne Mängel sind. ";
			task = task+"Um dies zu überprüfen, wird die Nullhypothese H0: p "+operator[op+2]+" "+p+"% auf dem Signifikanzniveau "+signiv+"% getestet ";
			task = task+"und "+n+" zufällig ausgewählte "+things[t]+" untersucht. Bestimmen Sie die Art des Test, der durchgeführt wird, sowie den zugehörigen Ablehungsbereich.";
			document.getElementById("Aufgabe").innerHTML = task;
			p = p/100;
			signiv = signiv/100;
			
			//Solve
			cumulative = 0;
			i = 0;
			if(op == 0){
				while(cumulative < (1-signiv)){
					cumulative += prop(i);
					i++;
				}
				solution[0] = i-1;
				solution[1] = n;
			}
			else {
				while(cumulative < (signiv)){
					cumulative += prop(i);
					i++;
				}
				solution[1] = i-2;
				solution[0] = 0;
			}
		}
		
		function check(){
			if(document.getElementById("leftborder").value && document.getElementById("rightborder") && (document.getElementById("left").checked || document.getElementById("right").checked)){
				string = "";
				test = false;
				if(op == 0 && document.getElementById("right").checked) test = true;
				else if (op == 1 && document.getElementById("left").checked) test = true;
				if(test) string = "Du hast die Art des Tests richtig erkannt!<br>";
				else string = "Du hast die Art des Tests leider nicht richtig erkannt!<br>";
				user = [];
				user[0] = parseInt(document.getElementById("leftborder").value);
				user[1] = parseInt(document.getElementById("rightborder").value);
				if(user[0] == solution[0] && user[1] == solution[1]) string = string+"Du hast den Ablehnungsbereich richtig angegeben!<p>";
				else string = string+"Du hast den Ablehnungsbereich leider nicht richtig angegeben!<p>";
				document.getElementById("return").innerHTML = string;
			}
		}
		
		function show(){
			if(op == 0) string = "Es wird ein rechtsseitiger Test durchgeführt.<br>"
			else string = "Es wird ein linksseitiger Test durchgeführt.<br>"
			string = string+"Der Ablehnungsbereich ist A = ["+solution[0]+", ... , "+solution[1]+"].<p>"
			document.getElementById("return").innerHTML = string;
		}
	</script>
	<body>
		<div id="Aufgabe"></div></br>
		<form>
		  Was für ein Test wird durchgeführt?<br>
		  <input type="radio" name="test" id="left">ein linksseitiger Test<br>
		  <input type="radio" name="test" id="right">ein rechtsseitiger Test</p>
		  Ablehnungsbereich:<br>
		  A = [<input name="bereich" id="leftborder" style="width:40px">, ... ,<input name="bereich" id="rightborder" style="width:40px">]
		</form>
		<p>
		<button id = "check" onClick="check()">Prüfen</button>
		<p>
		<div id="return"></div>
		<button onClick="show()">Lösung anzeigen</button>
		<p>
		<button onClick="aufgabe()">Neue Aufgabe</button>
	</body>
</html>